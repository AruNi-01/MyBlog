---
title: Object ç±»
subtitle: Object ç±»ä»‹ç»ã€ŒTag - Java åŸºç¡€ã€
author: AruNi_Lu
date: 2022-12-17
tags:
- Java åŸºç¡€
- Java

layout: Post
useHeaderImage: true
headerImage: https://aruni-01-github-io.oss-cn-beijing.aliyuncs.com/posts/Object.png
headerMask: rgba(40, 57, 101, .4)
catalog: true
---

ç€é‡ä»‹ç» equals å’Œ hashCode æ–¹æ³•

<!-- more --> 

::: tip æœ¬æ–‡å†…å®¹ï¼š
[[toc]]
:::

## 1. Object ä»‹ç»

**Object ç±»æ˜¯æ‰€æœ‰ç±»çš„çˆ¶ç±»**ï¼Œä»»ä½•ä¸€ä¸ªç±»éƒ½ **é—´æ¥æˆ–ç›´æ¥ç»§æ‰¿** è‡³ Object ç±»ï¼Œæ‰€æœ‰å¯¹è±¡ï¼ˆåŒ…æ‹¬æ•°ç»„ï¼‰éƒ½å®ç°äº†æ­¤ç±»çš„æ–¹æ³•ã€‚

å¦‚æœä¸€ä¸ªç±»æ²¡æœ‰ç›´æ¥æ˜ç¡®ç»§æ‰¿å“ªä¸€ä¸ªç±»ï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯ Object çš„ç›´æ¥å­ç±»ï¼š

```java
// éšå¼ç»§æ‰¿
class User {
}

// æ˜¾ç¤ºç»§æ‰¿
class User extends Object {
}
```

å› æ­¤ï¼ŒObject ç±»å¯ä»¥æ¥å—æ‰€æœ‰ **å¼•ç”¨æ•°æ®ç±»å‹**ï¼Œé€šè¿‡å‘ä¸‹è½¬ä¸ºéœ€è¦çš„ç±»å‹ä½¿ç”¨ã€‚

```java
Object o = new User(1, "å¼ ä¸‰");
User user = (User) o;
```



Object ä¸»è¦æä¾›äº†ä»¥ä¸‹ 11 ä¸ªæ–¹æ³•ï¼š

```java
/**
 * è¿”å›å½“å‰è¿è¡Œæ—¶å¯¹è±¡çš„ Class å¯¹è±¡
 */
public final native Class<?> getClass()
    
/**
 * è¿”å›å¯¹è±¡çš„å“ˆå¸Œç ï¼Œä¸»è¦ä½¿ç”¨åœ¨å“ˆå¸Œè¡¨ä¸­ï¼Œæ¯”å¦‚ HashMapã€HashSet ç­‰
 */
public native int hashCode()
    
/**
 * æ¯”è¾ƒ 2 ä¸ªå¯¹è±¡çš„å†…å­˜åœ°å€æ˜¯å¦ç›¸ç­‰ï¼ŒString ç±»å¯¹è¯¥æ–¹æ³•è¿›è¡Œäº†é‡å†™ä»¥ç”¨äºæ¯”è¾ƒå­—ç¬¦ä¸²çš„å€¼æ˜¯å¦ç›¸ç­‰
 */
public boolean equals(Object obj)
    
/**
 * åˆ›å»ºå¹¶è¿”å›å½“å‰å¯¹è±¡çš„ä¸€ä»½æ‹·è´
 */
protected native Object clone() throws CloneNotSupportedException
    
/**
 * è¿”å›å¯¹è±¡çš„ å­—ç¬¦ä¸² è¡¨ç¤ºå½¢å¼ï¼Œå»ºè®® Object æ‰€æœ‰çš„å­ç±»éƒ½é‡å†™è¿™ä¸ªæ–¹æ³•ã€‚
 */
public String toString()
    
/**
 * å”¤é†’ä¸€ä¸ªåœ¨æ­¤å¯¹è±¡ç›‘è§†å™¨ä¸Šç­‰å¾…çš„çº¿ç¨‹(ç›‘è§†å™¨ç›¸å½“äºå°±æ˜¯é”çš„æ¦‚å¿µ)ï¼Œå¦‚æœæœ‰å¤šä¸ªçº¿ç¨‹åœ¨ç­‰å¾…åªä¼šä»»æ„å”¤é†’ä¸€ä¸ªã€‚
 */
public final native void notify()
    
/**
 * è·Ÿ notify ä¸€æ ·ï¼Œå”¯ä¸€çš„åŒºåˆ«å°±æ˜¯ä¼šå”¤é†’åœ¨æ­¤å¯¹è±¡ç›‘è§†å™¨ä¸Šç­‰å¾…çš„æ‰€æœ‰çº¿ç¨‹ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªçº¿ç¨‹ã€‚
 */
public final native void notifyAll()
    
/**
 * æš‚åœçº¿ç¨‹çš„æ‰§è¡Œã€‚æ³¨æ„ï¼šsleep æ–¹æ³•æ²¡æœ‰é‡Šæ”¾é”ï¼Œè€Œ wait æ–¹æ³•é‡Šæ”¾äº†é” ï¼Œtimeout æ˜¯ç­‰å¾…æ—¶é—´ã€‚
 */
public final native void wait(long timeout) throws InterruptedException
    
/**
 * å¤šäº† nanos å‚æ•°ï¼Œè¿™ä¸ªå‚æ•°è¡¨ç¤ºé¢å¤–æ—¶é—´ï¼ˆä»¥æ¯«å¾®ç§’ä¸ºå•ä½ï¼‰ï¼Œæ‰€ä»¥è¶…æ—¶çš„æ—¶é—´è¿˜éœ€è¦åŠ ä¸Š nanos æ¯«ç§’ã€‚ã€‚
 */
public final void wait(long timeout, int nanos) throws InterruptedException
    
/**
 * è·Ÿä¹‹å‰çš„ 2 ä¸ª wait æ–¹æ³•ä¸€æ ·ï¼Œåªä¸è¿‡è¯¥æ–¹æ³•ä¸€ç›´ç­‰å¾…ï¼Œæ²¡æœ‰è¶…æ—¶æ—¶é—´è¿™ä¸ªæ¦‚å¿µ
 */
public final void wait() throws InterruptedException
    
/**
 * å®ä¾‹è¢«åƒåœ¾å›æ”¶å™¨å›æ”¶çš„æ—¶å€™è§¦å‘çš„æ“ä½œï¼ŒJDK 9 å·²å¼ƒç”¨
 */
protected void finalize() throws Throwable { }
```

## 2. equals() å’Œ == çš„åŒºåˆ«

`==` å¯¹äºåŸºæœ¬ç±»å‹å’Œå¼•ç”¨ç±»å‹çš„ä½œç”¨æ•ˆæœæ˜¯ä¸åŒçš„ï¼š

- å¯¹äº **åŸºæœ¬æ•°æ®ç±»å‹** ï¼Œ`==` æ¯”è¾ƒçš„æ˜¯å€¼ï¼›
- å¯¹äº **å¼•ç”¨æ•°æ®ç±»å‹**ï¼Œ`==` æ¯”è¾ƒçš„æ˜¯å¯¹è±¡çš„ **å†…å­˜åœ°å€**ï¼›

å› ä¸º Java åªæœ‰ **å€¼ä¼ é€’**ï¼Œæ‰€ä»¥ï¼Œå¯¹äº == æ¥è¯´ï¼Œä¸ç®¡æ˜¯æ¯”è¾ƒåŸºæœ¬æ•°æ®ç±»å‹ï¼Œè¿˜æ˜¯å¼•ç”¨æ•°æ®ç±»å‹çš„å˜é‡ï¼Œå…¶ **æœ¬è´¨æ¯”è¾ƒçš„éƒ½æ˜¯å€¼**ï¼Œåªä¸è¿‡ **å¼•ç”¨ç±»å‹** å˜é‡å­˜çš„å€¼æ˜¯ **å¯¹è±¡çš„åœ°å€**ã€‚

`equals()` ç”¨äºåˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡æ˜¯å¦ç›¸ç­‰ã€‚`equals()` æ–¹æ³•å­˜åœ¨äº `Object` ç±»ä¸­ï¼Œè€Œ `Object` ç±»æ˜¯æ‰€æœ‰ç±»çš„ç›´æ¥æˆ–é—´æ¥çˆ¶ç±»ï¼Œå› æ­¤ **æ‰€æœ‰çš„ç±»éƒ½æœ‰ `equals()` æ–¹æ³•**ã€‚

`equals()` æ–¹æ³•å­˜åœ¨ä¸¤ç§ä½¿ç”¨æƒ…å†µï¼š

- ç±»æ²¡æœ‰é‡å†™ `equals()` æ–¹æ³•ï¼šä½¿ç”¨çš„æ˜¯é»˜è®¤çš„ `Object` ç±»çš„ `equals()` æ–¹æ³•ï¼Œç›´æ¥ä½¿ç”¨ â€œ==â€ æ¯”è¾ƒï¼›
- ç±»é‡å†™äº† `equals()` æ–¹æ³•ï¼šæˆ‘ä»¬ä¸€èˆ¬éƒ½é‡å†™ `equals()` æ–¹æ³•æ¥æ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡ä¸­çš„ **å±æ€§** æ˜¯å¦ç›¸ç­‰ï¼›è‹¥å®ƒä»¬çš„å±æ€§ç›¸ç­‰ï¼Œåˆ™è¿”å› trueï¼›

ç¤ºä¾‹ï¼š

```java
class Test {
    public static void main(String[] args) {
        User user1 = new User(1, "å¼ ä¸‰");
        User user2 = new User(1, "å¼ ä¸‰");
        System.out.println(user1.equals(user2));	// false
    }
}

class User {
    int id;
    String name;
    
    // æ„é€ å‡½æ•°ç•¥
}
```

å¯ä»¥å‘ç°ï¼Œå½“æ²¡æœ‰é‡å†™ equals æ–¹æ³•æ—¶ï¼Œé»˜è®¤ä½¿ç”¨ Object çš„ equals æ–¹æ³•ï¼Œç›´æ¥ä½¿ç”¨ â€œ==â€ æ¯”è¾ƒï¼Œä¸¤ä¸ªå¯¹è±¡çš„åœ°å€å€¼è‚¯å®šä¸ä¸€æ ·ï¼Œè¿”å› falseã€‚

æ¥ä¸‹æ¥è‡ªå·±é‡å†™ equals æ–¹æ³•ï¼Œè¦æ±‚å¯¹è±¡çš„å€¼ç›¸åŒå³å¯è¿”å› trueï¼š

```java
class Test {
    public static void main(String[] args) {
        User user1 = new User(1, "å¼ ä¸‰");
        User user2 = new User(1, "å¼ ä¸‰");
        System.out.println(user1.equals(user2));	// true
    }
}

class User {
    int id;
    String name;
    
    @Override
    public boolean equals(Object o) {
        if (this == o) return true;
        if (o == null || getClass() != o.getClass()) return false;
        
        User user = (User) o;
        return this.id == user.id && this.name.equals(user.name);
    }
    
    // æ„é€ å‡½æ•°ç•¥
}
```

## 3. hashCode() æœ‰ä»€ä¹ˆç”¨ï¼Ÿ

### 3.1 hashCode() çš„ä½œç”¨

`hashCode()` çš„ä½œç”¨æ˜¯è·å–å“ˆå¸Œç ï¼ˆ`int` æ•´æ•°ï¼‰ï¼Œä¹Ÿç§°ä¸ºæ•£åˆ—ç ã€‚è¿™ä¸ªå“ˆå¸Œç çš„ä½œç”¨æ˜¯ç¡®å®šè¯¥å¯¹è±¡åœ¨å“ˆå¸Œè¡¨ä¸­çš„ç´¢å¼•ä½ç½®ã€‚

`hashCode()` å®šä¹‰åœ¨ JDK çš„ `Object` ç±»ä¸­ï¼Œè¿™å°±æ„å‘³ç€ Java ä¸­çš„ä»»ä½•ç±»éƒ½åŒ…å«æœ‰ `hashCode()` å‡½æ•°ã€‚

å¦å¤–éœ€è¦æ³¨æ„çš„æ˜¯ï¼š `Object` çš„ `hashCode()` æ–¹æ³•æ˜¯æœ¬åœ°æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯ç”¨ C è¯­è¨€æˆ– C++ å®ç°çš„ï¼Œè¯¥æ–¹æ³•é€šå¸¸ç”¨æ¥å°†å¯¹è±¡çš„å†…å­˜åœ°å€è½¬æ¢ä¸ºæ•´æ•°ä¹‹åè¿”å›ã€‚

æ•£åˆ—è¡¨å­˜å‚¨çš„æ˜¯é”®å€¼å¯¹(key-value)ï¼Œå®ƒçš„ç‰¹ç‚¹æ˜¯ï¼š**èƒ½æ ¹æ® â€œé”®â€ å¿«é€Ÿçš„æ£€ç´¢å‡ºå¯¹åº”çš„ â€œå€¼â€ã€‚è¿™å…¶ä¸­å°±åˆ©ç”¨åˆ°äº†å“ˆå¸Œç ï¼ï¼ˆå¯ä»¥å¿«é€Ÿæ‰¾åˆ°æ‰€éœ€è¦çš„å¯¹è±¡ï¼‰**

### 3.2 ä¸ºä»€ä¹ˆéœ€è¦ hashCodeï¼Ÿ

ä»¥ â€œ`HashSet` å¦‚ä½•æ£€æŸ¥é‡å¤â€ ä¸ºä¾‹å­æ¥è¯´æ˜ä¸ºä»€ä¹ˆè¦æœ‰ `hashCode`ï¼š

- å½“æŠŠå¯¹è±¡åŠ å…¥ `HashSet` æ—¶ï¼Œ`HashSet` ä¼šå…ˆè®¡ç®—å¯¹è±¡çš„ `hashCode` å€¼æ¥åˆ¤æ–­å¯¹è±¡åŠ å…¥çš„ä½ç½®ï¼ŒåŒæ—¶ä¹Ÿä¼šä¸å…¶ä»–å·²ç»åŠ å…¥çš„å¯¹è±¡çš„ `hashCode` å€¼ä½œæ¯”è¾ƒï¼›
- å¦‚æœæ²¡æœ‰ç›¸åŒçš„ `hashCode`ï¼Œ`HashSet` ä¼šå‡è®¾å¯¹è±¡æ²¡æœ‰é‡å¤å‡ºç°ï¼›
- ä½†æ˜¯å¦‚æœå‘ç° **æœ‰ç›¸åŒ `hashCode` å€¼çš„å¯¹è±¡**ï¼Œè¿™æ—¶ä¼š **è°ƒç”¨ `equals()` æ–¹æ³•** æ¥æ£€æŸ¥ `hashCode` ç›¸ç­‰çš„å¯¹è±¡æ˜¯å¦çœŸçš„ç›¸åŒï¼š
    - å¦‚æœä¸¤è€…ç›¸åŒï¼Œ`HashSet` å°±ä¸ä¼šè®©å…¶åŠ å…¥æ“ä½œæˆåŠŸã€‚
    - å¦‚æœ **ä¸åŒ** çš„è¯ï¼Œè¯´æ˜å‘ç”Ÿäº†å“ˆå¸Œå†²çªï¼Œå°±ä¼š **é‡æ–°æ•£åˆ—åˆ°å…¶ä»–ä½ç½®**ã€‚

å¯ä»¥å‘ç°ï¼ŒHashSet ä¼šå…ˆä½¿ç”¨ hashCode æ¥åˆ¤æ–­æ˜¯å¦æœ‰é‡å¤å…ƒç´ ï¼Œåªæœ‰å½“ HashCode ç›¸ç­‰æ—¶ï¼ˆå‘ç”Ÿäº†å“ˆå¸Œå†²çªï¼‰ï¼Œæ‰ä¼šè°ƒç”¨ equals æ–¹æ³•è¿›ä¸€æ­¥åˆ¤æ–­å¯¹è±¡æ˜¯å¦çœŸçš„ç›¸ç­‰ã€‚è¿™æ ·æˆ‘ä»¬å°± **å¤§å¤§å‡å°‘äº† `equals` çš„è°ƒç”¨æ¬¡æ•°ï¼Œæé«˜äº†æ‰§è¡Œé€Ÿåº¦**ã€‚

å› æ­¤ï¼Œ`hashCode()` å’Œ `equals()` å…¶å®éƒ½æ˜¯ç”¨äºæ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡æ˜¯å¦ç›¸ç­‰ï¼Œåªä¸è¿‡ hashCode() çš„è¯´æœåŠ›æ²¡æœ‰é‚£ä¹ˆå¼ºï¼Œæ¯•ç«Ÿ hashCode å­˜åœ¨å“ˆå¸Œå†²çªã€‚

å› ä¸ºå­˜åœ¨å“ˆå¸Œå†²çªçš„å¯èƒ½ï¼Œå› æ­¤ **ä¸¤ä¸ªå¯¹è±¡çš„ `hashCode` å€¼ç›¸ç­‰å¹¶ä¸ä»£è¡¨ä¸¤ä¸ªå¯¹è±¡å°±ç›¸ç­‰**ã€‚

ç°åœ¨é—®é¢˜åˆæ¥äº†ï¼Œæ—¢ç„¶ `hashCode()` æ²¡æœ‰ `equals()` è¯´æœåŠ›å¼ºï¼Œé‚£ä¸ºä»€ä¹ˆè¿˜éœ€è¦ `hashCode()` å‘¢ï¼Ÿç›´æ¥ä½¿ç”¨ `equals()` ä¸å°±å¥½äº†å—ï¼Ÿï¼Ÿ

è¿™æ˜¯å› ä¸ºåœ¨ä¸€äº›å®¹å™¨ï¼ˆæ¯”å¦‚ `HashMap`ã€`HashSet`ï¼‰ä¸­ï¼Œæœ‰äº† `hashCode()` ä¹‹åï¼Œ**åˆ¤æ–­å…ƒç´ æ˜¯å¦åœ¨å¯¹åº”å®¹å™¨ä¸­çš„æ•ˆç‡ä¼šæ›´é«˜**ï¼ˆå‚è€ƒæ·»åŠ å…ƒç´ è¿› `HashSet` çš„è¿‡ç¨‹ï¼‰ã€‚

æ€»ç»“ä¸‹æ¥å°±æ˜¯ï¼š

- å¦‚æœä¸¤ä¸ªå¯¹è±¡çš„ `hashCode` å€¼ç›¸ç­‰ï¼Œé‚£è¿™ä¸¤ä¸ªå¯¹è±¡ä¸ä¸€å®šç›¸ç­‰ï¼ˆå“ˆå¸Œç¢°æ’ï¼‰ï¼›
- å¦‚æœä¸¤ä¸ªå¯¹è±¡çš„ `hashCode` å€¼ç›¸ç­‰ï¼Œä¸” `equals()` ä¹Ÿè¿”å› `true`ï¼Œæ‰è®¤ä¸ºè¿™ä¸¤ä¸ªå¯¹è±¡ç›¸ç­‰ï¼›
- å¦‚æœä¸¤ä¸ªå¯¹è±¡çš„ `hashCode` å€¼ä¸ç›¸ç­‰ï¼Œé‚£ä¹ˆç›´æ¥è‚¯å®šè¿™ä¸¤ä¸ªå¯¹è±¡ä¸ç›¸ç­‰ï¼›

### 3.3 é‡å†™ equals() æ—¶å¿…é¡»é‡å†™ hashCode() ï¼Ÿ

æ¯ä¸ªç±»çš„ç”¨é€”ä¸ä¸€æ ·ï¼Œå› æ­¤ä¸‹é¢åˆ†ä¸º **è¯¥ç±»æ˜¯å¦è¢«æ•£åˆ—è¡¨ä½¿ç”¨** æ¥è®¨è®ºã€‚

::: info ç±»ä¸ä¼šè¢«æ•£åˆ—è¡¨ä½¿ç”¨
ğŸ¥±
:::

å½“æˆ‘ä»¬ä¸åœ¨ HashSetï¼ŒHashTableï¼ŒHashMap ç­‰ç­‰è¿™äº› **æœ¬è´¨æ˜¯æ•£åˆ—è¡¨** çš„æ•°æ®ç»“æ„ä¸­ç”¨åˆ°è¿™ä¸ªç±»æ—¶ï¼Œ`equals()` ç”¨æ¥æ¯”è¾ƒè¯¥ç±»çš„ä¸¤ä¸ªå¯¹è±¡æ˜¯å¦ç›¸ç­‰ï¼Œè€Œ **hashCode() åˆ™æ ¹æœ¬ä½¿ç”¨ä¸åˆ°**ã€‚

å› ä¸ºä¸æ˜¯æ•£åˆ—è¡¨çš„ç»“æ„ä¸­ï¼Œä¸ä¼šè°ƒç”¨ä»€ä¹ˆ `hashCode()` æ–¹æ³•ï¼Œæ‰€ä»¥ **é‡ä¸é‡å†™éƒ½æ²¡å…³ç³»**ã€‚

::: info ç±»ä¼šè¢«æ•£åˆ—è¡¨ä½¿ç”¨
ğŸ¥±
:::

å½“è¯¥ç±»ä¼šè¢«æ•£åˆ—è¡¨ä½¿ç”¨æ—¶ï¼Œè¯¥ç±»çš„ `hashCode()` å’Œ `equals` æ˜¯æœ‰å…³ç³»çš„ï¼š

- å¦‚æœä¸¤ä¸ªå¯¹è±¡ç›¸ç­‰ï¼Œé‚£ä¹ˆå®ƒä»¬çš„ hashCode() å€¼ä¸€å®šç›¸åŒã€‚è¿™é‡Œçš„ â€œå¯¹è±¡ç›¸ç­‰â€ æ˜¯æŒ‡é€šè¿‡ `equals()` æ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡æ—¶è¿”å› trueï¼›
- å¦‚æœä¸¤ä¸ªå¯¹è±¡çš„ **hashCode ç›¸ç­‰**ï¼Œ**å®ƒä»¬çš„ `equals()` ä¸ä¸€å®šç›¸ç­‰**ã€‚å› ä¸ºå­˜åœ¨ **å“ˆå¸Œå†²çª**ï¼›

å› ä¸ºæ•£åˆ—è¡¨çš„æ•°æ®ç»“æ„ HashSetã€HashMap ç­‰åœ¨æ–¹æ³•ä¸­éƒ½ä¼šè°ƒç”¨ `hashCode()` æ–¹æ³•ï¼Œæ‰€ä»¥ä¸ºäº†å®‰å…¨ï¼Œå¿…é¡»é‡å†™ `hashCode()`ã€‚

**è‹¥æ²¡æœ‰é‡å†™ `hashCode()`ï¼Œä¼šæœ‰ä»€ä¹ˆé—®é¢˜å‘¢**ï¼Ÿ

åœ¨æ·»åŠ å¯¹è±¡æ—¶ï¼šå¦‚æœ **åªé‡å†™äº† equals**ï¼Œé‚£ä¹ˆåªè¦ **å€¼ç›¸ç­‰**ï¼Œæˆ‘ä»¬å°±è®¤ä¸ºå¯¹è±¡ç›¸ç­‰ï¼Œä½†è‹¥è¿™ä¸¤ä¸ªå¯¹è±¡çš„ **å“ˆå¸Œå€¼ä¸ç›¸ç­‰**ï¼Œåœ¨ **HashSet ä¸­æ ¹æ®å“ˆå¸Œå€¼** æ¥åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡æ˜¯å¦ç›¸ç­‰æ—¶å°±ä¼š **è®¤ä¸ºè¿™ä¸¤ä¸ªå¯¹è±¡ä¸ç›¸ç­‰**ï¼Œå› æ­¤å°†å®ƒä»¬ **éƒ½è£…å…¥é›†åˆä¸­**ï¼Œè¿™æ˜¾ç„¶æ˜¯æœ‰é—®é¢˜çš„ã€‚

ä¾‹å¦‚ï¼Œä¸‹é¢æˆ‘ä»¬åªé‡å†™äº† `equals()`ï¼Œå¯ä»¥å‘ç°ï¼Œæˆ‘ä»¬è®¤ä¸ºä¸¤ä¸ªå¯¹è±¡çš„å€¼ç›¸ç­‰å°±æ˜¯ç›¸åŒäº†ï¼Œä½†ç”±äºå®ƒä»¬çš„ hashCode ä¸åŒï¼ŒHashSet å°†å®ƒä»¬éƒ½æ·»åŠ è¿›é›†åˆäº†ï¼š

```java
class Test {
    public static void main(String[] args) {
        User user1 = new User(1, "aaa"), user2 = new User(1, "aaa");
        HashSet<User> set = new HashSet<>();
        set.add(user1); set.add(user2);
        for (User user : set) System.out.println(user);
    }
}
/* è¾“å‡ºï¼š
User{id=1, name='aaa'}
User{id=1, name='aaa'}
*/

class User {
    int id;
    String name;

    @Override
    public boolean equals(Object o) {
        if (this == o) return true;
        if (o == null || getClass() != o.getClass()) return false;

        User user = (User) o;
        return this.id == user.id && this.name.equals(user.name);
    }
    
    // æ„é€ æ–¹æ³•ã€toString() ç•¥
}
```

ç°åœ¨æˆ‘ä»¬é‡å†™ `hashCode()`ï¼Œæ ¹æ® id å’Œ name å±æ€§æ¥ç”Ÿæˆ hashCodeï¼Œä¿è¯å¯¹è±¡çš„å±æ€§å€¼ç›¸åŒï¼ŒhashCode ä¹Ÿç›¸åŒã€‚æ­¤æ—¶ HashSet ä¸­åªæœ‰ä¸€ä¸ªå¯¹è±¡ï¼š

```java
class Test {
    public static void main(String[] args) {
        User user1 = new User(1, "aaa"), user2 = new User(1, "aaa");
        HashSet<User> set = new HashSet<>();
        set.add(user1); set.add(user2);
        for (User user : set) System.out.println(user);
    }
}
/* è¾“å‡ºï¼š
User{id=1, name='aaa'}
*/

class User {
    int id;
    String name;

    @Override
    public boolean equals(Object o) {
        if (this == o) return true;
        if (o == null || getClass() != o.getClass()) return false;

        User user = (User) o;
        return this.id == user.id && this.name.equals(user.name);
    }
    
    @Override
    public int hashCode() {
        // æ ¹æ® id å’Œ name å±æ€§æ¥ç”Ÿæˆ hashCode
        return Objects.hash(id, name);
    }
    
    // æ„é€ æ–¹æ³•ã€toString() ç•¥
}
```

å¦‚æœä½ ç¿»å¼€è¿‡ String ç±»çš„æºç ï¼Œä¼šå‘ç° String ç±»ä¸ä»…é‡å†™äº† `equals()`ï¼Œè¿˜é‡å†™äº† `hashCode()` æ–¹æ³•ï¼Œå› ä¸º String ç±»æ˜¯æˆ‘ä»¬ç¼–ç¨‹æ—¶ä½¿ç”¨å¾—æœ€å¤šçš„ç±»ï¼Œä¹Ÿå¸¸å¸¸å°†å®ƒç”¨ä½œ HashMap çš„ keyï¼Œè€Œ HashMap çš„ key æ˜¯ä¸å¯ä»¥é‡å¤çš„ã€‚æ­£å› ä¸º String ç±»å·²ç»å¸®æˆ‘ä»¬é‡å†™å¥½äº†ç›¸å…³æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨ String ç±»æ—¶æ‰å¦‚æ­¤æ–¹ä¾¿å®‰å…¨ã€‚

## 4. å‚è€ƒæ–‡ç« 

::: link {https://javaguide.cn/favicon.ico} [Java Guide](https://javaguide.cn/)

:::